# Using pre-existing Kubernetes secrets for Sim
# For GitOps, Sealed Secrets, or manual secret management

# Prerequisites:
# Create your secrets before installing (see examples at bottom of file)

app:
  enabled: true
  replicaCount: 2
  secrets:
    existingSecret:
      enabled: true
      name: "sim-app-secrets"
  env:
    NEXT_PUBLIC_APP_URL: "https://sim.example.com"
    BETTER_AUTH_URL: "https://sim.example.com"
    NEXT_PUBLIC_SOCKET_URL: "wss://sim-ws.example.com"
    NODE_ENV: "production"

realtime:
  enabled: true
  replicaCount: 2
  env:
    NEXT_PUBLIC_APP_URL: "https://sim.example.com"
    BETTER_AUTH_URL: "https://sim.example.com"
    NEXT_PUBLIC_SOCKET_URL: "wss://sim-ws.example.com"
    ALLOWED_ORIGINS: "https://sim.example.com"
    NODE_ENV: "production"

postgresql:
  enabled: true
  auth:
    username: postgres
    database: sim
    existingSecret:
      enabled: true
      name: "sim-postgresql-secret"
      passwordKey: "POSTGRES_PASSWORD"

# ---
# Create secrets before installing:
# ---

# kubectl create secret generic sim-app-secrets \
#   --namespace sim \
#   --from-literal=BETTER_AUTH_SECRET="$(openssl rand -hex 32)" \
#   --from-literal=ENCRYPTION_KEY="$(openssl rand -hex 32)" \
#   --from-literal=INTERNAL_API_SECRET="$(openssl rand -hex 32)" \
#   --from-literal=CRON_SECRET="$(openssl rand -hex 32)" \
#   --from-literal=API_ENCRYPTION_KEY="$(openssl rand -hex 32)"

# kubectl create secret generic sim-postgresql-secret \
#   --namespace sim \
#   --from-literal=POSTGRES_PASSWORD="$(openssl rand -base64 16 | tr -d '/+=')"
