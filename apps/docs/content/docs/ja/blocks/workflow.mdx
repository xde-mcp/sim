---
title: ワークフローブロック
description: 現在のフロー内で別のワークフローを実行する
---

import { Callout } from 'fumadocs-ui/components/callout'
import { Image } from '@/components/ui/image'

## 機能

<div className='flex justify-center my-6'>
  <Image
    src='/static/blocks/workflow.png'
    alt='ワークフローブロックの設定'
    width={500}
    height={400}
    className='rounded-xl border border-border shadow-sm'
  />
</div>

より大きなフローの一部として子ワークフローを呼び出したい場合は、ワークフローブロックをドロップします。このブロックは、そのワークフローの最新デプロイバージョンを実行し、完了するまで待機してから、親ワークフローを続行します。

## 設定方法

1. **ワークフローを選択** ドロップダウンから選びます（ループを防ぐため自己参照はブロックされています）。
2. **入力のマッピング**: 子ワークフローに入力フォームトリガーがある場合、各フィールドが表示され、親変数を接続できます。マッピングされた値が子ワークフローが受け取る内容になります。

<div className='flex justify-center my-6'>
  <Image
    src='/static/blocks/workflow-2.png'
    alt='入力マッピング例を示すワークフローブロック'
    width={700}
    height={400}
    className='rounded-xl border border-border shadow-sm'
  />
</div>

3. **出力**: 子ワークフローが完了すると、ブロックは以下を公開します：
   - `result` – 子ワークフローの最終応答
   - `success` – エラーなく実行されたかどうか
   - `error` – 実行が失敗した場合のメッセージ

## デプロイメントステータスバッジ

ワークフローブロックは、子ワークフローが実行準備ができているかどうかを追跡するのに役立つデプロイメントステータスバッジを表示します：

- **デプロイ済み** – 子ワークフローがデプロイされ、使用準備ができています。ブロックは現在デプロイされているバージョンを実行します。
- **未デプロイ** – 子ワークフローが一度もデプロイされていません。ワークフローブロックが実行する前にデプロイする必要があります。
- **再デプロイ** – 最後のデプロイ以降、子ワークフローに変更が検出されました。バッジをクリックして、最新の変更で子ワークフローを再デプロイしてください。

<Callout type="warn">
ワークフローブロックは常に子ワークフローの最新デプロイバージョンを実行し、エディタバージョンではありません。変更を加えた後は必ず再デプロイして、ブロックが最新のロジックを使用するようにしてください。
</Callout>

## 実行に関する注意事項

- 子ワークフローは同じワークスペースコンテキストで実行されるため、環境変数やツールは引き継がれます。
- ブロックはデプロイメントバージョン管理を使用します：API、スケジュール、ウェブフック、手動、またはチャット実行はすべてデプロイされたスナップショットを呼び出します。子ワークフローを変更した場合は再デプロイしてください。
- 子ワークフローが失敗した場合、下流で処理しない限り、ブロックはエラーを発生させます。

<Callout>
子ワークフローは焦点を絞ったものにしましょう。小さく再利用可能なフローは、深いネストを作成せずに組み合わせやすくなります。
</Callout>
