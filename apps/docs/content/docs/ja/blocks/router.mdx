---
title: ルーター
---

import { Callout } from 'fumadocs-ui/components/callout'
import { Tab, Tabs } from 'fumadocs-ui/components/tabs'
import { Image } from '@/components/ui/image'

ルーターブロックはAIを使用してコンテンツ分析に基づいてワークフローをインテリジェントにルーティングします。単純なルールを使用する条件ブロックとは異なり、ルーターはコンテキストと意図を理解します。

<div className="flex justify-center">
  <Image
    src="/static/blocks/router.png"
    alt="複数のパスを持つルーターブロック"
    width={500}
    height={400}
    className="my-6"
  />
</div>

## ルーターと条件の比較

**ルーターを使用する場合：**
- AIを活用したコンテンツ分析が必要な時
- 非構造化または多様なコンテンツを扱う時
- 意図ベースのルーティングが必要な時（例：「サポートチケットを部門にルーティングする」）

**条件を使用する場合：**
- 単純なルールベースの判断で十分な時
- 構造化データや数値比較を扱う時
- 高速で決定論的なルーティングが必要な時

## 設定オプション

### コンテンツ/プロンプト

ルーターがルーティング判断を行うために分析するコンテンツまたはプロンプト。これには以下が含まれます：

- ユーザーからの直接的な質問や入力
- 前のブロックからの出力
- システム生成メッセージ

### ターゲットブロック

ルーターが選択できる可能な宛先ブロック。ルーターは接続されたブロックを自動的に検出しますが、以下のこともできます：

- ルーティング精度を向上させるためにターゲットブロックの説明をカスタマイズする
- 各ターゲットブロックのルーティング基準を指定する
- 特定のブロックをルーティングターゲットとして考慮から除外する

### モデル選択

ルーティング判断を行うAIモデルを選択します：

- **OpenAI**：GPT-4o、o1、o3、o4-mini、gpt-4.1
- **Anthropic**：Claude 3.7 Sonnet
- **Google**：Gemini 2.5 Pro、Gemini 2.0 Flash
- **その他のプロバイダー**：Groq、Cerebras、xAI、DeepSeek
- **ローカルモデル**：Ollama互換モデル

最良の結果を得るには、GPT-4oやClaude 3.7 Sonnetなど、強力な推論能力を持つモデルを使用してください。

### APIキー

選択したLLMプロバイダーのAPIキー。これは安全に保存され、認証に使用されます。

## 出力

- **`<router.prompt>`**: ルーティングプロンプトの要約
- **`<router.selected_path>`**: 選択された宛先ブロック
- **`<router.tokens>`**: トークン使用統計
- **`<router.cost>`**: 推定ルーティングコスト
- **`<router.model>`**: 意思決定に使用されるモデル

## 使用例

**カスタマーサポートの振り分け** - チケットを専門部署にルーティング

```
Input (Ticket) → Router → Agent (Engineering) or Agent (Finance)
```

**コンテンツ分類** - ユーザー生成コンテンツを分類しルーティング

```
Input (Feedback) → Router → Workflow (Product) or Workflow (Technical)
```

**リード資格評価** - 資格基準に基づいてリードをルーティング

```
Input (Lead) → Router → Agent (Enterprise Sales) or Workflow (Self-serve)
```

## ベストプラクティス

- **明確な対象の説明を提供する**: 具体的で詳細な説明で、各宛先をいつ選択すべきかをルーターが理解できるようにする
- **具体的なルーティング基準を使用する**: 各経路に明確な条件と例を定義して精度を向上させる
- **フォールバックパスを実装する**: 特定の経路が適切でない場合のデフォルトの宛先を接続する
- **多様な入力でテストする**: ルーターが様々な入力タイプ、エッジケース、予期しないコンテンツを処理できることを確認する
- **ルーティングパフォーマンスを監視する**: ルーティングの決定を定期的に確認し、実際の使用パターンに基づいて基準を改善する
- **適切なモデルを選択する**: 複雑なルーティング決定には強力な推論能力を持つモデルを使用する
