---
title: Microsoft Teams
description: Teams でメッセージ、リアクション、メンバーを管理する
---

import { BlockInfoCard } from "@/components/ui/block-info-card"

<BlockInfoCard 
  type="microsoft_teams"
  color="#E0E0E0"
/>

{/* MANUAL-CONTENT-START:intro */}
[Microsoft Teams](https://teams.microsoft.com)は、チームや組織内でリアルタイムメッセージング、会議、コンテンツ共有を可能にする強力なコミュニケーションおよびコラボレーションプラットフォームです。Microsoftの生産性エコシステムの一部として、Microsoft Teamsは Office 365と統合されたシームレスなチャット機能を提供し、ユーザーがメッセージを投稿し、作業を調整し、デバイスやワークフロー間で接続を維持することができます。

Microsoft Teamsでは、次のことが可能です：

- **メッセージの送受信**: チャットスレッドで個人やグループとリアルタイムにコミュニケーション  
- **リアルタイムでのコラボレーション**: チャンネルやチャット内でチーム全体に更新情報を共有  
- **会話の整理**: スレッド化された議論と永続的なチャット履歴でコンテキストを維持  
- **ファイルとコンテンツの共有**: チャット内で直接ドキュメント、画像、リンクを添付・閲覧  
- **Microsoft 365との統合**: Outlook、SharePoint、OneDriveなどとシームレスに連携  
- **複数デバイスでのアクセス**: デスクトップ、ウェブ、モバイルでクラウド同期された会話を利用  
- **安全なコミュニケーション**: エンタープライズグレードのセキュリティとコンプライアンス機能を活用

Simでは、Microsoft Teams統合により、エージェントがプログラムによってチャットメッセージと直接やり取りすることができます。これにより、更新の送信、アラートの投稿、タスクの調整、リアルタイムでの会話への応答など、強力な自動化シナリオが可能になります。エージェントは、チャットやチャンネルに新しいメッセージを書き込んだり、ワークフローデータに基づいてコンテンツを更新したり、コラボレーションが行われる場所でユーザーとやり取りしたりすることができます。SimとMicrosoft Teamsを統合することで、インテリジェントなワークフローとチームコミュニケーションの間のギャップを埋め、エージェントがコラボレーションを効率化し、コミュニケーションタスクを自動化し、チームの連携を維持できるようにします。
{/* MANUAL-CONTENT-END */}

## 使用手順

Microsoft Teams をワークフローに統合します。チャットやチャネルのメッセージの読み取り、書き込み、更新、削除ができます。メッセージへの返信、リアクションの追加、チーム/チャネルメンバーの一覧表示が可能です。チャットやチャネルにメッセージが送信されたときにワークフローをトリガーするトリガーモードでも使用できます。メッセージでユーザーにメンションするには、名前を `<at>` タグで囲みます: `<at>userName</at>`

## ツール

### `microsoft_teams_read_chat`

Microsoft Teamsチャットからコンテンツを読み取る

#### 入力

| パラメータ | 型 | 必須 | 説明 |
| --------- | ---- | -------- | ----------- |
| `chatId` | string | はい | 読み取り元のチャットID |
| `includeAttachments` | boolean | いいえ | メッセージの添付ファイル（ホストされたコンテンツ）をダウンロードしてストレージに含める |

#### 出力

| パラメータ | 型 | 説明 |
| --------- | ---- | ----------- |
| `success` | boolean | Teamsチャット読み取り操作の成功ステータス |
| `messageCount` | number | チャットから取得したメッセージ数 |
| `chatId` | string | 読み取り元のチャットID |
| `messages` | array | チャットメッセージオブジェクトの配列 |
| `attachmentCount` | number | 見つかった添付ファイルの総数 |
| `attachmentTypes` | array | 見つかった添付ファイルの種類 |
| `content` | string | チャットメッセージのフォーマット済みコンテンツ |
| `attachments` | file[] | 利便性のためにアップロードされた添付ファイル（フラット化済み） |

### `microsoft_teams_write_chat`

Microsoft Teams チャットでコンテンツを作成または更新する

#### 入力

| パラメータ | 型 | 必須 | 説明 |
| --------- | ---- | -------- | ----------- |
| `chatId` | string | はい | 書き込み先のチャットID |
| `content` | string | はい | メッセージに書き込む内容 |
| `files` | file[] | いいえ | メッセージに添付するファイル |

#### 出力

| パラメータ | 型 | 説明 |
| --------- | ---- | ----------- |
| `success` | boolean | Teams チャットメッセージ送信成功ステータス |
| `messageId` | string | 送信されたメッセージの一意の識別子 |
| `chatId` | string | メッセージが送信されたチャットのID |
| `createdTime` | string | メッセージが作成されたタイムスタンプ |
| `url` | string | メッセージへのウェブURL |
| `updatedContent` | boolean | コンテンツが正常に更新されたかどうか |

### `microsoft_teams_read_channel`

Microsoft Teams チャネルからコンテンツを読み取る

#### 入力

| パラメータ | 型 | 必須 | 説明 |
| --------- | ---- | -------- | ----------- |
| `teamId` | string | はい | 読み取り元のチームID |
| `channelId` | string | はい | 読み取り元のチャネルID |
| `includeAttachments` | boolean | いいえ | メッセージの添付ファイル（ホストされたコンテンツ）をダウンロードしてストレージに含める |

#### 出力

| パラメータ | 型 | 説明 |
| --------- | ---- | ----------- |
| `success` | boolean | Teamsチャネル読み取り操作の成功ステータス |
| `messageCount` | number | チャネルから取得したメッセージ数 |
| `teamId` | string | 読み取り元のチームID |
| `channelId` | string | 読み取り元のチャネルID |
| `messages` | array | チャネルメッセージオブジェクトの配列 |
| `attachmentCount` | number | 見つかった添付ファイルの総数 |
| `attachmentTypes` | array | 見つかった添付ファイルの種類 |
| `content` | string | チャネルメッセージのフォーマット済みコンテンツ |
| `attachments` | file[] | 利便性のためにアップロードされた添付ファイル（フラット化済み） |

### `microsoft_teams_write_channel`

Microsoft Teamsチャネルにメッセージを書き込むまたは送信する

#### 入力

| パラメータ | 型 | 必須 | 説明 |
| --------- | ---- | -------- | ----------- |
| `teamId` | string | はい | 書き込み先のチームID |
| `channelId` | string | はい | 書き込み先のチャネルID |
| `content` | string | はい | チャネルに書き込む内容 |
| `files` | file[] | いいえ | メッセージに添付するファイル |

#### 出力

| パラメータ | 種類 | 説明 |
| --------- | ---- | ----------- |
| `success` | boolean | Teamsチャネルメッセージ送信成功ステータス |
| `messageId` | string | 送信されたメッセージの一意識別子 |
| `teamId` | string | メッセージが送信されたチームのID |
| `channelId` | string | メッセージが送信されたチャネルのID |
| `createdTime` | string | メッセージが作成されたタイムスタンプ |
| `url` | string | メッセージへのウェブURL |
| `updatedContent` | boolean | コンテンツが正常に更新されたかどうか |

### `microsoft_teams_update_chat_message`

Microsoft Teams チャットの既存メッセージを更新する

#### 入力

| パラメータ | 型 | 必須 | 説明 |
| --------- | ---- | -------- | ----------- |
| `chatId` | string | はい | メッセージを含むチャットのID |
| `messageId` | string | はい | 更新するメッセージのID |
| `content` | string | はい | メッセージの新しい内容 |

#### 出力

| パラメータ | 型 | 説明 |
| --------- | ---- | ----------- |
| `success` | boolean | 更新が成功したかどうか |
| `messageId` | string | 更新されたメッセージのID |
| `updatedContent` | boolean | コンテンツが正常に更新されたかどうか |

### `microsoft_teams_update_channel_message`

Microsoft Teams チャネルの既存メッセージを更新する

#### 入力

| パラメータ | 型 | 必須 | 説明 |
| --------- | ---- | -------- | ----------- |
| `teamId` | string | はい | チームのID |
| `channelId` | string | はい | メッセージを含むチャネルのID |
| `messageId` | string | はい | 更新するメッセージのID |
| `content` | string | はい | メッセージの新しい内容 |

#### 出力

| パラメータ | 型 | 説明 |
| --------- | ---- | ----------- |
| `success` | boolean | 更新が成功したかどうか |
| `messageId` | string | 更新されたメッセージのID |
| `updatedContent` | boolean | コンテンツが正常に更新されたかどうか |

### `microsoft_teams_delete_chat_message`

Microsoft Teamsチャットでメッセージをソフト削除する

#### 入力

| パラメータ | 型 | 必須 | 説明 |
| --------- | ---- | -------- | ----------- |
| `chatId` | string | はい | メッセージを含むチャットのID |
| `messageId` | string | はい | 削除するメッセージのID |

#### 出力

| パラメータ | 型 | 説明 |
| --------- | ---- | ----------- |
| `success` | boolean | 削除が成功したかどうか |
| `deleted` | boolean | 削除の確認 |
| `messageId` | string | 削除されたメッセージのID |

### `microsoft_teams_delete_channel_message`

Microsoft Teamsチャネルでメッセージをソフト削除する

#### 入力

| パラメータ | 型 | 必須 | 説明 |
| --------- | ---- | -------- | ----------- |
| `teamId` | string | はい | チームのID |
| `channelId` | string | はい | メッセージを含むチャネルのID |
| `messageId` | string | はい | 削除するメッセージのID |

#### 出力

| パラメータ | 型 | 説明 |
| --------- | ---- | ----------- |
| `success` | boolean | 削除が成功したかどうか |
| `deleted` | boolean | 削除の確認 |
| `messageId` | string | 削除されたメッセージのID |

### `microsoft_teams_reply_to_message`

Microsoft Teamsチャネルの既存のメッセージに返信する

#### 入力

| パラメータ | 型 | 必須 | 説明 |
| --------- | ---- | -------- | ----------- |
| `teamId` | string | はい | チームのID |
| `channelId` | string | はい | チャネルのID |
| `messageId` | string | はい | 返信するメッセージのID |
| `content` | string | はい | 返信の内容 |

#### 出力

| パラメータ | 型 | 説明 |
| --------- | ---- | ----------- |
| `success` | boolean | 返信が成功したかどうか |
| `messageId` | string | 返信メッセージのID |
| `updatedContent` | boolean | コンテンツが正常に送信されたかどうか |

### `microsoft_teams_get_message`

Microsoft Teamsのチャットまたはチャネルから特定のメッセージを取得する

#### 入力

| パラメータ | 型 | 必須 | 説明 |
| --------- | ---- | -------- | ----------- |
| `teamId` | string | いいえ | チームのID（チャネルメッセージの場合） |
| `channelId` | string | いいえ | チャネルのID（チャネルメッセージの場合） |
| `chatId` | string | いいえ | チャットのID（チャットメッセージの場合） |
| `messageId` | string | はい | 取得するメッセージのID |

#### 出力

| パラメータ | 型 | 説明 |
| --------- | ---- | ----------- |
| `success` | boolean | 取得が成功したかどうか |
| `content` | string | メッセージの内容 |
| `metadata` | object | 送信者、タイムスタンプなどを含むメッセージのメタデータ |

### `microsoft_teams_set_reaction`

Microsoft Teamsのメッセージに絵文字リアクションを追加する

#### 入力

| パラメータ | 型 | 必須 | 説明 |
| --------- | ---- | -------- | ----------- |
| `teamId` | string | いいえ | チームのID（チャネルメッセージの場合） |
| `channelId` | string | いいえ | チャネルのID（チャネルメッセージの場合） |
| `chatId` | string | いいえ | チャットのID（チャットメッセージの場合） |
| `messageId` | string | はい | リアクションするメッセージのID |
| `reactionType` | string | はい | 絵文字リアクション（例：❤️、👍、😊） |

#### 出力

| パラメータ | 型 | 説明 |
| --------- | ---- | ----------- |
| `success` | boolean | リアクションが正常に追加されたかどうか |
| `reactionType` | string | 追加された絵文字 |
| `messageId` | string | メッセージのID |

### `microsoft_teams_unset_reaction`

Microsoft Teamsのメッセージから絵文字リアクションを削除する

#### 入力

| パラメータ | 型 | 必須 | 説明 |
| --------- | ---- | -------- | ----------- |
| `teamId` | string | いいえ | チームのID（チャネルメッセージの場合） |
| `channelId` | string | いいえ | チャネルのID（チャネルメッセージの場合） |
| `chatId` | string | いいえ | チャットのID（チャットメッセージの場合） |
| `messageId` | string | はい | メッセージのID |
| `reactionType` | string | はい | 削除する絵文字リアクション（例：❤️、👍、😊） |

#### 出力

| パラメータ | 型 | 説明 |
| --------- | ---- | ----------- |
| `success` | boolean | リアクションが正常に削除されたかどうか |
| `reactionType` | string | 削除された絵文字 |
| `messageId` | string | メッセージのID |

### `microsoft_teams_list_team_members`

Microsoft Teamsチームのすべてのメンバーを一覧表示する

#### 入力

| パラメータ | 型 | 必須 | 説明 |
| --------- | ---- | -------- | ----------- |
| `teamId` | string | はい | チームのID |

#### 出力

| パラメータ | 型 | 説明 |
| --------- | ---- | ----------- |
| `success` | boolean | 一覧表示が成功したかどうか |
| `members` | array | チームメンバーの配列 |
| `memberCount` | number | メンバーの総数 |

### `microsoft_teams_list_channel_members`

Microsoft Teamsチャネルのすべてのメンバーを一覧表示する

#### 入力

| パラメータ | 型 | 必須 | 説明 |
| --------- | ---- | -------- | ----------- |
| `teamId` | string | はい | チームのID |
| `channelId` | string | はい | チャネルのID |

#### 出力

| パラメータ | 型 | 説明 |
| --------- | ---- | ----------- |
| `success` | boolean | 一覧表示が成功したかどうか |
| `members` | array | チャネルメンバーの配列 |
| `memberCount` | number | メンバーの総数 |

## 注意事項

- カテゴリー: `tools`
- タイプ: `microsoft_teams`
