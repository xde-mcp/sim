---
title: MCPツールの使用
description: Model Context Protocolを使用して外部ツールとサービスを接続
---

import { Image } from '@/components/ui/image'
import { Video } from '@/components/ui/video'
import { Callout } from 'fumadocs-ui/components/callout'

モデルコンテキストプロトコル（[MCP](https://modelcontextprotocol.com/)）を使用すると、標準化されたプロトコルを使用して外部ツールやサービスを接続し、APIやサービスをワークフローに直接統合することができます。MCPを使用することで、エージェントやワークフローとシームレスに連携するカスタム統合機能を追加して、Simの機能を拡張できます。

## MCPとは？

MCPは、AIアシスタントが外部データソースやツールに安全に接続できるようにするオープンスタンダードです。以下のような標準化された方法を提供します：

- データベース、API、ファイルシステムへの接続
- 外部サービスからのリアルタイムデータへのアクセス
- カスタムツールやスクリプトの実行
- 外部リソースへの安全で制御されたアクセスの維持

## MCPサーバーの設定

MCPサーバーはエージェントが使用できるツールのコレクションを提供します。ワークスペース設定で構成してください：

<div className="mx-auto w-full overflow-hidden rounded-lg">
  <Video src="mcp/settings-mcp-tools.mp4" width={700} height={450} />
</div>

1. ワークスペース設定に移動します
2. **MCP サーバー**セクションに移動します
3. **MCPサーバーを追加**をクリックします
4. サーバー設定の詳細を入力します
5. 設定を保存します

<Callout type="info">
エージェントブロックのツールバーから直接MCPサーバーを構成することもできます（クイックセットアップ）。
</Callout>

### ツールの更新

サーバーの**更新**をクリックすると、最新のツールスキーマを取得し、それらのツールを使用しているエージェントブロックを新しいパラメータ定義で自動的に更新します。

## エージェントでのMCPツールの使用

MCPサーバーが設定されると、そのツールがエージェントブロック内で利用可能になります：

<div className="flex justify-center">
  <Image
    src="/static/blocks/mcp-2.png"
    alt="エージェントブロックでのMCPツールの使用"
    width={700}
    height={450}
    className="my-6"
  />
</div>

1. **エージェント**ブロックを開く
2. **ツール**セクションで、利用可能なMCPツールが表示されます
3. エージェントに使用させたいツールを選択
4. エージェントは実行中にこれらのツールにアクセスできるようになります

## スタンドアロンMCPツールブロック

より細かい制御が必要な場合は、専用のMCPツールブロックを使用して特定のMCPツールを実行できます：

<div className="flex justify-center">
  <Image
    src="/static/blocks/mcp-3.png"
    alt="スタンドアロンMCPツールブロック"
    width={700}
    height={450}
    className="my-6"
  />
</div>

MCPツールブロックでは次のことができます：
- 設定済みのMCPツールを直接実行
- ツールに特定のパラメータを渡す
- ツールの出力を後続のワークフローステップで使用
- 複数のMCPツールを連鎖させる

### MCPツールとエージェントの使い分け

**MCPツールを使用したエージェントを使用する場合：**
- AIにどのツールを使用するか決定させたい
- ツールをいつどのように使用するかについて複雑な推論が必要
- ツールとの自然言語による対話が必要

**MCPツールブロックを使用する場合：**
- 決定論的なツール実行が必要な場合
- 既知のパラメータで特定のツールを実行したい場合
- 予測可能なステップで構造化されたワークフローを構築している場合

## 権限要件

MCP機能には特定のワークスペース権限が必要です：

| アクション | 必要な権限 |
|--------|-------------------|
| 設定でMCPサーバーを構成 | **管理者** |
| エージェントでMCPツールを使用 | **書き込み**または**管理者** |
| 利用可能なMCPツールを表示 | **読み取り**、**書き込み**、または**管理者** |
| MCPツールブロックを実行 | **書き込み**または**管理者** |

## 一般的な使用例

### データベース統合
データベースに接続して、ワークフロー内でデータのクエリ、挿入、更新を行います。

### API統合
Simに組み込まれていない外部APIやWebサービスにアクセスします。

### ファイルシステムアクセス
ローカルまたはリモートのファイルシステム上のファイルの読み取り、書き込み、操作を行います。

### カスタムビジネスロジック
組織固有のニーズに合わせたカスタムスクリプトやツールを実行します。

### リアルタイムデータアクセス
ワークフロー実行中に外部システムからライブデータを取得します。

## セキュリティに関する考慮事項

- MCPサーバーは、それを構成したユーザーの権限で実行されます
- インストール前に必ずMCPサーバーのソースを確認してください
- 機密性の高い構成データには環境変数を使用してください
- エージェントにアクセスを許可する前にMCPサーバーの機能を確認してください

## トラブルシューティング

### MCPサーバーが表示されない
- サーバー構成が正しいことを確認してください
- 必要な権限があることを確認してください
- MCPサーバーが実行中でアクセス可能であることを確認してください

### ツール実行の失敗
- ツールパラメータが正しくフォーマットされていることを確認してください
- エラーメッセージについてMCPサーバーログを確認してください
- 必要な認証が構成されていることを確認してください

### 権限エラー
- ワークスペースの権限レベルを確認してください
- MCPサーバーが追加の認証を必要としているか確認してください
- サーバーがワークスペースに対して適切に設定されているか確認してください